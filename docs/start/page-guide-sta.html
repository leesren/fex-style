<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据统计 | 前端技术文档库</title>
    <meta name="description" content="前端不规范,运营两行泪">
    
    
    <link rel="preload" href="/assets/css/0.styles.aae91c30.css" as="style"><link rel="preload" href="/assets/js/app.14ead82b.js" as="script"><link rel="preload" href="/assets/js/2.bcb6ef02.js" as="script"><link rel="preload" href="/assets/js/29.82036977.js" as="script"><link rel="prefetch" href="/assets/js/10.6bb4e319.js"><link rel="prefetch" href="/assets/js/11.bd6f584c.js"><link rel="prefetch" href="/assets/js/12.eeda7bc1.js"><link rel="prefetch" href="/assets/js/13.9a9566da.js"><link rel="prefetch" href="/assets/js/14.29644010.js"><link rel="prefetch" href="/assets/js/15.5f389412.js"><link rel="prefetch" href="/assets/js/16.251bda90.js"><link rel="prefetch" href="/assets/js/17.a13b0b50.js"><link rel="prefetch" href="/assets/js/18.98327b77.js"><link rel="prefetch" href="/assets/js/19.058408a3.js"><link rel="prefetch" href="/assets/js/20.0fc5794f.js"><link rel="prefetch" href="/assets/js/21.38d0c6d7.js"><link rel="prefetch" href="/assets/js/22.b995d7c5.js"><link rel="prefetch" href="/assets/js/23.240df2cc.js"><link rel="prefetch" href="/assets/js/24.708f82cb.js"><link rel="prefetch" href="/assets/js/25.176745f0.js"><link rel="prefetch" href="/assets/js/26.bbc334bd.js"><link rel="prefetch" href="/assets/js/27.f47f1e4e.js"><link rel="prefetch" href="/assets/js/28.538bc36d.js"><link rel="prefetch" href="/assets/js/3.1293461d.js"><link rel="prefetch" href="/assets/js/30.73459d65.js"><link rel="prefetch" href="/assets/js/31.774c055d.js"><link rel="prefetch" href="/assets/js/32.e8f99a4f.js"><link rel="prefetch" href="/assets/js/33.78bc7be2.js"><link rel="prefetch" href="/assets/js/34.fee89f8a.js"><link rel="prefetch" href="/assets/js/35.b7c73dd3.js"><link rel="prefetch" href="/assets/js/36.2add09bc.js"><link rel="prefetch" href="/assets/js/37.c3b983a4.js"><link rel="prefetch" href="/assets/js/38.4f651f56.js"><link rel="prefetch" href="/assets/js/39.1269f6c8.js"><link rel="prefetch" href="/assets/js/4.eb8b53cf.js"><link rel="prefetch" href="/assets/js/40.405ac88d.js"><link rel="prefetch" href="/assets/js/41.1e29a730.js"><link rel="prefetch" href="/assets/js/42.1385091b.js"><link rel="prefetch" href="/assets/js/43.2ed5464a.js"><link rel="prefetch" href="/assets/js/44.cd5328cb.js"><link rel="prefetch" href="/assets/js/45.2f10d53a.js"><link rel="prefetch" href="/assets/js/46.55a26b76.js"><link rel="prefetch" href="/assets/js/47.30d9b656.js"><link rel="prefetch" href="/assets/js/48.47f394a2.js"><link rel="prefetch" href="/assets/js/49.58c42480.js"><link rel="prefetch" href="/assets/js/5.97ca143a.js"><link rel="prefetch" href="/assets/js/50.232ee3c8.js"><link rel="prefetch" href="/assets/js/51.4be0f151.js"><link rel="prefetch" href="/assets/js/52.f2471c96.js"><link rel="prefetch" href="/assets/js/53.966c282a.js"><link rel="prefetch" href="/assets/js/54.5c45411b.js"><link rel="prefetch" href="/assets/js/55.dec314fc.js"><link rel="prefetch" href="/assets/js/6.904e71cc.js"><link rel="prefetch" href="/assets/js/7.8d9e8164.js"><link rel="prefetch" href="/assets/js/8.9626c522.js"><link rel="prefetch" href="/assets/js/9.d6096fcc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aae91c30.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端技术文档库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">指南</a></div><div class="nav-item"><a href="/start/" class="nav-link router-link-active">快速上手</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">指南</a></div><div class="nav-item"><a href="/start/" class="nav-link router-link-active">快速上手</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>快速上手</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/start/" class="sidebar-link">快速上手</a></li><li><a href="/start/restructure-frontend-rules-choice.html" class="sidebar-link">重构答疑</a></li><li><a href="/start/restructure-frontend-shape-screen.html" class="sidebar-link">游戏内异形屏适配规范</a></li><li><a href="/start/restructure-frontend-rules-html.html" class="sidebar-link">HTML 编码规范</a></li><li><a href="/start/restructure-frontend-rules-css.html" class="sidebar-link">CSS 编码规范</a></li><li><a href="/start/restructure-frontend-rules-js.html" class="sidebar-link">Javascript 编码规范</a></li><li><a href="/start/restructure-frontend-rules-vue.html" class="sidebar-link">Vue.js 组件编码规范</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/start/page-guide" class="sidebar-heading clickable open"><span>页面规范</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/start/page-guide-header.html" class="sidebar-link">页面头部</a></li><li><a href="/start/page-guide-css.html" class="sidebar-link">CSS 规范</a></li><li><a href="/start/page-guide-name.html" class="sidebar-link">注释与命名</a></li><li><a href="/start/page-guide-dir.html" class="sidebar-link">文件目录</a></li><li><a href="/start/page-guide-img.html" class="sidebar-link">图片处理</a></li><li><a href="/start/page-guide-sta.html" class="active sidebar-link">数据统计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/start/page-guide-sta.html#页面-pv-统计代码" class="sidebar-link">页面 PV 统计代码</a></li><li class="sidebar-sub-header"><a href="/start/page-guide-sta.html#关于-setsite-project" class="sidebar-link">关于 setSite.project</a></li><li class="sidebar-sub-header"><a href="/start/page-guide-sta.html#曝光埋点" class="sidebar-link">曝光埋点</a></li><li class="sidebar-sub-header"><a href="/start/page-guide-sta.html#按钮上报" class="sidebar-link">按钮上报</a></li><li class="sidebar-sub-header"><a href="/start/page-guide-sta.html#adtag-上报" class="sidebar-link">ADTAG 上报</a></li><li class="sidebar-sub-header"><a href="/start/page-guide-sta.html#虚拟上报" class="sidebar-link">虚拟上报</a></li><li class="sidebar-sub-header"><a href="/start/page-guide-sta.html#其他上报方式" class="sidebar-link">其他上报方式</a></li></ul></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>----PC端----</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/start/page-guide-pc-compatible.html" class="sidebar-link">浏览器兼容</a></li><li><a href="/start/page-guide-pc-share.html" class="sidebar-link">页面分享</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>----移动端----</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/start/page-guide-mobile-design.html" class="sidebar-link">移动端页面设计规范</a></li><li><a href="/start/page-guide-mobile-font.html" class="sidebar-link">移动端页面字体使用参考</a></li><li><a href="/start/page-guide-mobile-rem.html" class="sidebar-link">rem 布局</a></li><li><a href="/start/page-guide-mobile-compatible.html" class="sidebar-link">移动端页面兼容要求</a></li><li><a href="/start/page-guide-mobile-media.html" class="sidebar-link">移动端 H5 页面音频/视频规范</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/start/tools" class="sidebar-heading clickable"><span>工具/系统</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/start/spec" class="sidebar-heading clickable"><span>特殊规范</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/start/reading-more" class="sidebar-heading clickable"><span>扩展阅读</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/start/fe-nav.html" class="sidebar-link">前端导航</a></li><li><a href="/start/change-log.html" class="sidebar-link">更新日志</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="数据统计"><a href="#数据统计" aria-hidden="true" class="header-anchor">#</a> 数据统计</h1> <p>页面需要使用 <strong>PTT 统计代码组件</strong><code>ping_tcss_tgideas_https_min.js</code>进行数据上报。</p> <p>如没有正确执行上报，少加、漏加、错加代码将导致页面统计不到任何数据，后果很严重。</p> <p>页面重构完成后请仔细检查，并且详细阅读以下说明。</p> <h2 id="页面-pv-统计代码"><a href="#页面-pv-统计代码" aria-hidden="true" class="header-anchor">#</a> 页面 PV 统计代码</h2> <p>需要在页面底部添加 <code>PTT 统计代码</code>，如果是官网记得 <code>siteType</code> 属性填写为 <code>os</code></p> <div class="warning custom-block"><p class="custom-block-title">警告</p> <p>PTT 的主函数 pgvMain() 请不要延迟执行，建议直接调用，或者最迟在 document.DOMContentLoaded(即通常理解的 domReady) 事件内调用。晚于此时间点上报统计请求，有<code>统计数据丢失</code>的风险，也会触发<code>网页质量工单</code>。</p></div> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>//ossweb-img.qq.com/images/js/PTT/ping_tcss_tgideas_https_min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">//此段代码不能放到外链JS中，</span>
  <span class="token keyword">var</span> setSite <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//设置网站属性</span>
    siteType<span class="token punctuation">:</span> <span class="token string">'a20160711xxx'</span><span class="token punctuation">,</span> <span class="token comment">//必填项:&quot;os&quot;代表是官网，如果不是，则填写actName例如a20160701xxx</span>
    pageType<span class="token punctuation">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token comment">//必填项:本页面的定位；按照页面含义填写例如main||list||detail||download||share||page1||pageN,不支持点(.)、下划线(_)</span>
    pageName<span class="token punctuation">:</span> <span class="token string">'首页'</span><span class="token punctuation">,</span> <span class="token comment">//必填项:页面中文名</span>
    project<span class="token punctuation">:</span> <span class="token string">'other'</span><span class="token punctuation">,</span> <span class="token comment">//选填项:如果是官网模块则是必填;按照模块内容，填写固定的对应值;官网微社区base;同人站doujin;赛事match;故事站story;文化站history;粉丝站fans;爆料站coming;论坛bbs;皮肤skin;默认other;</span>
    osact<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token comment">//选填项:默认是0。osact=0表示非官网专题；osact=pc表示pc官网/pc官网专题；osact=m表示移动官网/移动官网专题；osact=ingame表示微社区/微社区专题</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pgvMain <span class="token operator">==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token function">pgvMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//千万不能忘记！</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意</p> <p>siteType 要么填写 os 要么填写文件夹名称，不要直接复制照搬，必须全小写。
PTT 所有埋点如有多个单词拼接，请使用英文中横线(-)，禁止所有其他写法例如点(.)、下划线(<code>_</code>)、英文逗号(,)、驼峰式(大小写)等，包括但不限于 siteType、pageType、pageName、PTTSendClick、exposure。</p></div> <p>一般只需要改的是前三项 siteType、pageType、pageName，其中 pageType 和 pageName 可以自定义，可参考上面代码中的注释。</p> <div class="danger custom-block"><p class="custom-block-title">不要遗漏</p> <p>不要忘了在加载完 PTT 组件后，执行 <code>if(typeof(pgvMain)=='function')pgvMain();</code></p></div> <p>如果使用 PTT 上报方式，以下组件由于 PTT 上报已经集成故不能使用，会冲突：</p> <ul><li>js/comm/stayTime.min.js 停留时间统计组件</li> <li>js/comm/pagecount.min.js 停留时间统计组件</li> <li>js/comm/exposure.min.js 触达率/曝光次数统计组件</li></ul> <h2 id="关于-setsite-project"><a href="#关于-setsite-project" aria-hidden="true" class="header-anchor">#</a> 关于 setSite.project</h2> <p>选填，目的是区分官网类型，在官网体系内是必填项。</p> <p>例如隶属于官网体系的赛事中心，会有自己的主页、资讯列表页详情页等，这个时候需要细化官网体系，就需要 project 区分；</p> <p><strong>按照模块内容，填写固定的对应值；</strong></p> <table><thead><tr><th>站点类型</th> <th style="text-align:center;">project 值</th></tr></thead> <tbody><tr><td>原生官网</td> <td style="text-align:center;">base</td></tr> <tr><td>微社区</td> <td style="text-align:center;">ingame</td></tr> <tr><td>同人站</td> <td style="text-align:center;">doujin</td></tr> <tr><td>赛事</td> <td style="text-align:center;">match</td></tr> <tr><td>故事站</td> <td style="text-align:center;">story</td></tr> <tr><td>文化站</td> <td style="text-align:center;">history</td></tr> <tr><td>粉丝站</td> <td style="text-align:center;">fans</td></tr> <tr><td>爆料站</td> <td style="text-align:center;">coming</td></tr> <tr><td>论坛</td> <td style="text-align:center;">bbs</td></tr> <tr><td>皮肤</td> <td style="text-align:center;">skin</td></tr></tbody></table> <p>如果什么都不填，则自动默认值为 other。</p> <p>如果以上可选项都不适用于该内容模块，请联系需求接口人。</p> <h2 id="曝光埋点"><a href="#曝光埋点" aria-hidden="true" class="header-anchor">#</a> 曝光埋点</h2> <p>用来统计官网的模块的曝光量和模块点击；</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>官网一定要添加</p></div> <h3 id="使用方法"><a href="#使用方法" aria-hidden="true" class="header-anchor">#</a> 使用方法</h3> <p>PC 端和移动端用法一样； 在官网模块 dom 结构上添加 exposure-tag=&quot;英文名,中文解释&quot; 属性及值；</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>news<span class="token punctuation">&quot;</span></span> <span class="token attr-name">exposure-tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>英文名,中文解释<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 例如： --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>news<span class="token punctuation">&quot;</span></span> <span class="token attr-name">exposure-tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>news,新闻<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>官网曝光埋点案例：</strong></p> <p><img src="https://game.gtimg.cn/images/tgideas/doc/cntimg/gitbook/spec/common-datareport1.png" alt=""></p> <h2 id="按钮上报"><a href="#按钮上报" aria-hidden="true" class="header-anchor">#</a> 按钮上报</h2> <h3 id="pc-端"><a href="#pc-端" aria-hidden="true" class="header-anchor">#</a> PC 端</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 开始游戏 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>PTTSendClick('btn','start','开始游戏');<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>开始游戏<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 分享给朋友 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>PTTSendClick('btn','share','分享');<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>分享给朋友<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 预约--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>PTTSendClick('btn','order','预约');<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>预约<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 下载游戏 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>PTTSendClick('btn','download','下载游戏');<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>下载游戏<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 视频播放 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>PTTSendClick('btn','playvideo','播放视频');<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>播放视频<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="移动端"><a href="#移动端" aria-hidden="true" class="header-anchor">#</a> 移动端</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btnStart<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>开始游戏<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>//ossweb-img.qq.com/images/js/mobile_build/util/zepto.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#btnStart'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">PTTSendClick</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">,</span> <span class="token string">'start'</span><span class="token punctuation">,</span> <span class="token string">'开始游戏'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>直接在 dom 元素上增加 onclick 事件，在传递参数的时候，请确保双引号和单引号的嵌套使用正确。 页面中，PTTSendClick 传递的第二个参数不能重复，必须是唯一值</p></div> <p>如页面为翻屏形式，在每次翻屏结束时的回调函数中执行上报，其中 e.nowpage 为当前页,e.nextpage 为翻屏触达的页</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">PTTSendClick</span><span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">,</span> <span class="token string">'page'</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>nowpage <span class="token operator">+</span> <span class="token string">'to'</span> <span class="token operator">+</span> <span class="token string">'page'</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>nextpage<span class="token punctuation">,</span> <span class="token string">'翻屏'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>H5 专题中，如需要统计页面加载流失等，可以将 PTT 组件前置放在 head 中，JS 脚本执行</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">PTTSendClick</span><span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">,</span> <span class="token string">'loadstart'</span><span class="token punctuation">,</span> <span class="token string">'开始加载'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在页面加载完成的回调函数中执行</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">PTTSendClick</span><span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">,</span> <span class="token string">'loadend'</span><span class="token punctuation">,</span> <span class="token string">'加载结束'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>如在脚本中使用到 PTTSendClick，比方说统计流失率。</p> <p>在页面的进入执行 PTTSendClick('loading','loadstart','开始加载');</p> <p>以及加载完成执行 PTTSendClick('loading','loadend','加载完成')进行数据上报时候，需要确保在此之前 PTT 组件已经加载完成且已经执行过 pgvMain 这个函数，不然执行 PTTSendClick 会报错。</p></div> <h2 id="adtag-上报"><a href="#adtag-上报" aria-hidden="true" class="header-anchor">#</a> ADTAG 上报</h2> <p>数据上报还有另外一种方式是在链接上加一个参数，用于特定渠道访问量统计。比如链接是http://pvp.qq.com，那在后面拼接参数ADTAG=专题名称.位置.描述</p> <p>注：用英文句号.做分割，最多不可超过 4 个</p> <p>最终为：http://pvp.qq.com?ADTAG=a20170505.btn.logo</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>如果原链接本来就带参数，比如<code>http://pvp.qq.com/path/page.html?id=123,加上&amp;再拼接即可</code>，和平常的<code>url</code>传参方式一样。</p> <p>最终为：<code>http://pvp.qq.com/path/page.html?id=123&amp;ADTAG=a20170505.btn.logo</code></p></div> <h2 id="虚拟上报"><a href="#虚拟上报" aria-hidden="true" class="header-anchor">#</a> 虚拟上报</h2> <p>虚拟上报分为虚拟域名和虚拟页面</p> <ul><li>虚拟页面</li></ul> <p>如果一个页面需要区分多种情况，可以构造不同的虚拟 URL，这样就可以使用虚拟后的 URL 查看此页面的数据，</p> <p>其中 virtualURL：虚拟 URL，注意不要包含域名。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pgvMain <span class="token operator">==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token function">pgvMain</span><span class="token punctuation">(</span><span class="token punctuation">{</span> virtualURL<span class="token punctuation">:</span> <span class="token string">'/path/xxx.html'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>虚拟域名</li></ul> <p>适用情形：如果一个页面需要上报数据到另外的域名，可以构造虚拟域名，构造虚拟域名后需在虚拟域名下查看该页面的数据</p> <p>virtualDomain：虚拟域名，会发送这个域名到点击流服务器</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pgvMain <span class="token operator">==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token function">pgvMain</span><span class="token punctuation">(</span><span class="token punctuation">{</span> virtualDomain<span class="token punctuation">:</span> <span class="token string">'xxx.qq.com'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="其他上报方式"><a href="#其他上报方式" aria-hidden="true" class="header-anchor">#</a> 其他上报方式</h2> <p>除非项目指定使用以下 ping_tcss_ied 上报数据，否则统一使用上面的 PTT 统计代码组件</p> <ul><li><strong>页面 PV 统计</strong></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 底部加入JS --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>//pingjs.qq.com/ping_tcss_ied.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pgvMain <span class="token operator">==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">pgvMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li><strong>按钮上报</strong></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 按钮上报，参数为：专题名称.页面名称.元素描述.功能 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>pgvSendClick({hottag:'a20150825file.index.btn.open'});<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>使用<code>ping_tcss_ied</code>上报时候，虚拟上报和 ADTAG 使用同 <code>PTT 统计代码组件</code>。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/start/page-guide-img.html" class="prev">图片处理</a></span> <span class="next"><a href="/start/page-guide-pc-compatible.html">浏览器兼容</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.14ead82b.js" defer></script><script src="/assets/js/2.bcb6ef02.js" defer></script><script src="/assets/js/29.82036977.js" defer></script>
  </body>
</html>
