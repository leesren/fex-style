<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>重构答疑 | 前端技术文档库</title>
    <meta name="description" content="前端不规范,运营两行泪">
    
    
    <link rel="preload" href="/fex-style/assets/css/0.styles.6790ac8c.css" as="style"><link rel="preload" href="/fex-style/assets/js/app.3df72f28.js" as="script"><link rel="preload" href="/fex-style/assets/js/2.bcb6ef02.js" as="script"><link rel="preload" href="/fex-style/assets/js/33.d718e1d0.js" as="script"><link rel="prefetch" href="/fex-style/assets/js/10.10f36252.js"><link rel="prefetch" href="/fex-style/assets/js/11.bd6f584c.js"><link rel="prefetch" href="/fex-style/assets/js/12.516b1a26.js"><link rel="prefetch" href="/fex-style/assets/js/13.3135106e.js"><link rel="prefetch" href="/fex-style/assets/js/14.3ea882d7.js"><link rel="prefetch" href="/fex-style/assets/js/15.69da73a8.js"><link rel="prefetch" href="/fex-style/assets/js/16.e0eaec8a.js"><link rel="prefetch" href="/fex-style/assets/js/17.c5c0ff8c.js"><link rel="prefetch" href="/fex-style/assets/js/18.1bd34d9e.js"><link rel="prefetch" href="/fex-style/assets/js/19.058408a3.js"><link rel="prefetch" href="/fex-style/assets/js/20.4d67b27f.js"><link rel="prefetch" href="/fex-style/assets/js/21.38d0c6d7.js"><link rel="prefetch" href="/fex-style/assets/js/22.b995d7c5.js"><link rel="prefetch" href="/fex-style/assets/js/23.8f6a5e49.js"><link rel="prefetch" href="/fex-style/assets/js/24.377a7dac.js"><link rel="prefetch" href="/fex-style/assets/js/25.5029c6fa.js"><link rel="prefetch" href="/fex-style/assets/js/26.a844b30f.js"><link rel="prefetch" href="/fex-style/assets/js/27.6d63f2e0.js"><link rel="prefetch" href="/fex-style/assets/js/28.538bc36d.js"><link rel="prefetch" href="/fex-style/assets/js/29.c9180f5a.js"><link rel="prefetch" href="/fex-style/assets/js/3.1293461d.js"><link rel="prefetch" href="/fex-style/assets/js/30.6a1b5e33.js"><link rel="prefetch" href="/fex-style/assets/js/31.1abf6a96.js"><link rel="prefetch" href="/fex-style/assets/js/32.01d6c7b4.js"><link rel="prefetch" href="/fex-style/assets/js/34.a3204600.js"><link rel="prefetch" href="/fex-style/assets/js/35.ed2f8d91.js"><link rel="prefetch" href="/fex-style/assets/js/36.2add09bc.js"><link rel="prefetch" href="/fex-style/assets/js/37.c3b983a4.js"><link rel="prefetch" href="/fex-style/assets/js/38.7f614d2d.js"><link rel="prefetch" href="/fex-style/assets/js/39.c311c5e8.js"><link rel="prefetch" href="/fex-style/assets/js/4.eb8b53cf.js"><link rel="prefetch" href="/fex-style/assets/js/40.d02689eb.js"><link rel="prefetch" href="/fex-style/assets/js/41.98baada8.js"><link rel="prefetch" href="/fex-style/assets/js/42.1385091b.js"><link rel="prefetch" href="/fex-style/assets/js/43.7aabc0d4.js"><link rel="prefetch" href="/fex-style/assets/js/44.9839e4de.js"><link rel="prefetch" href="/fex-style/assets/js/45.2f10d53a.js"><link rel="prefetch" href="/fex-style/assets/js/46.55a26b76.js"><link rel="prefetch" href="/fex-style/assets/js/47.d3b188d4.js"><link rel="prefetch" href="/fex-style/assets/js/48.f0c4345a.js"><link rel="prefetch" href="/fex-style/assets/js/49.39270b4f.js"><link rel="prefetch" href="/fex-style/assets/js/5.0cad5e13.js"><link rel="prefetch" href="/fex-style/assets/js/50.232ee3c8.js"><link rel="prefetch" href="/fex-style/assets/js/51.ff7d3667.js"><link rel="prefetch" href="/fex-style/assets/js/52.a10b853f.js"><link rel="prefetch" href="/fex-style/assets/js/53.51eb976e.js"><link rel="prefetch" href="/fex-style/assets/js/54.5c45411b.js"><link rel="prefetch" href="/fex-style/assets/js/55.dec314fc.js"><link rel="prefetch" href="/fex-style/assets/js/6.904e71cc.js"><link rel="prefetch" href="/fex-style/assets/js/7.59b38ed6.js"><link rel="prefetch" href="/fex-style/assets/js/8.9626c522.js"><link rel="prefetch" href="/fex-style/assets/js/9.d6096fcc.js">
    <link rel="stylesheet" href="/fex-style/assets/css/0.styles.6790ac8c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fex-style/" class="home-link router-link-active"><!----> <span class="site-name">前端技术文档库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fex-style/" class="nav-link">指南</a></div><div class="nav-item"><a href="/fex-style/start/" class="nav-link router-link-active">快速上手</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fex-style/" class="nav-link">指南</a></div><div class="nav-item"><a href="/fex-style/start/" class="nav-link router-link-active">快速上手</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>快速上手</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fex-style/start/" class="sidebar-link">快速上手</a></li><li><a href="/fex-style/start/restructure-frontend-rules-choice.html" class="active sidebar-link">重构答疑</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fex-style/start/restructure-frontend-rules-choice.html#一、重构环节" class="sidebar-link">一、重构环节</a></li><li class="sidebar-sub-header"><a href="/fex-style/start/restructure-frontend-rules-choice.html#二、开发环节" class="sidebar-link">二、开发环节</a></li><li class="sidebar-sub-header"><a href="/fex-style/start/restructure-frontend-rules-choice.html#三、测试环节" class="sidebar-link">三、测试环节</a></li></ul></li><li><a href="/fex-style/start/restructure-frontend-shape-screen.html" class="sidebar-link">游戏内异形屏适配规范</a></li><li><a href="/fex-style/start/restructure-frontend-rules-html.html" class="sidebar-link">HTML 编码规范</a></li><li><a href="/fex-style/start/restructure-frontend-rules-css.html" class="sidebar-link">CSS 编码规范</a></li><li><a href="/fex-style/start/restructure-frontend-rules-js.html" class="sidebar-link">Javascript 编码规范</a></li><li><a href="/fex-style/start/restructure-frontend-rules-vue.html" class="sidebar-link">Vue.js 组件编码规范</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/fex-style/start/page-guide" class="sidebar-heading clickable"><span>页面规范</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/fex-style/start/tools" class="sidebar-heading clickable"><span>工具/系统</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/fex-style/start/spec" class="sidebar-heading clickable"><span>特殊规范</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/fex-style/start/reading-more" class="sidebar-heading clickable"><span>扩展阅读</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/fex-style/start/fe-nav.html" class="sidebar-link">前端导航</a></li><li><a href="/fex-style/start/change-log.html" class="sidebar-link">更新日志</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="重构答疑"><a href="#重构答疑" aria-hidden="true" class="header-anchor">#</a> 重构答疑</h1> <p>重构可以当做是制作横屏的移动官网来实现，内容的接入，也是和双端官网一致，不同的是测试环节，会有一些类似登录态，白名单的环节，在下方测试环节，均会提及</p> <h2 id="一、重构环节"><a href="#一、重构环节" aria-hidden="true" class="header-anchor">#</a> 一、重构环节</h2> <h3 id="横屏微社区，竖屏如何兼顾？"><a href="#横屏微社区，竖屏如何兼顾？" aria-hidden="true" class="header-anchor">#</a> 横屏微社区，竖屏如何兼顾？</h3> <p>横屏的微社区一般设计师很少会设计竖屏版本，因为重构基本可以自行处理。</p> <p><strong>规则：</strong></p> <ul><li><p>左侧 fixed 导航-&gt;底部 fixed 导航</p></li> <li><p>左栏变为顶部，右栏随后</p></li></ul> <h3 id="微社区常用-js，iconfont-字体库"><a href="#微社区常用-js，iconfont-字体库" aria-hidden="true" class="header-anchor">#</a> 微社区常用 JS，iconfont 字体库</h3> <p>微社区公共字体库</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'igfont'</span><span class="token punctuation">;</span>
  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>'//ossweb-img.qq.com/images/js/bsCommonFiles/iconfont/iconfont.eot'<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>'//ossweb-img.qq.com/images/js/bsCommonFiles/iconfont/iconfont.eot?#iefix'<span class="token punctuation">)</span></span>
      <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'embedded-opentype'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>'//ossweb-img.qq.com/images/js/bsCommonFiles/iconfont/iconfont.svg#iconfont'<span class="token punctuation">)</span></span>
      <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>'//ossweb-img.qq.com/images/js/bsCommonFiles/iconfont/iconfont.woff'<span class="token punctuation">)</span></span>
      <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'woff'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>'//ossweb-img.qq.com/images/js/bsCommonFiles/iconfont/iconfont.ttf'<span class="token punctuation">)</span></span>
      <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'truetype'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.igfont</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'igfont'</span> <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token property">font-style</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
  <span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased<span class="token punctuation">;</span>
  <span class="token property">-webkit-text-stroke-width</span><span class="token punctuation">:</span> 0.1px<span class="token punctuation">;</span>
  <span class="token property">-moz-osx-font-smoothing</span><span class="token punctuation">:</span> grayscale<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>图标集合地址：<code>http://ossweb-img.qq.com/images/js/bsCommonFiles/iconfont/demo_unicode.html</code></p> <h3 id="微社区常用-js-目录"><a href="#微社区常用-js-目录" aria-hidden="true" class="header-anchor">#</a> 微社区常用 JS 目录</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># gitlab 仓库</span>
</code></pre></div><h3 id="seo-问题可以忽略？"><a href="#seo-问题可以忽略？" aria-hidden="true" class="header-anchor">#</a> seo 问题可以忽略？</h3> <p>是的，场景在游戏内，无需考虑 SEO 问题</p> <h3 id="是否能使用-vuejs？"><a href="#是否能使用-vuejs？" aria-hidden="true" class="header-anchor">#</a> 是否能使用 VueJs？</h3> <p>VUE 框架在微社区中应用广泛，是微社区目前推荐的框架，也能快速提高开发速度。附上版本对应的 JS 地址</p> <div class="language- extra-class"><pre class="language-text"><code>https://ossweb-img.qq.com/images/js/bsCommonFiles/js/vue2.min.js //vue 2.0
https://ossweb-img.qq.com/images/js/bsCommonFiles/js/vue.js //vue 1.0
</code></pre></div><h3 id="适配能否像移动官网那样用-rem？"><a href="#适配能否像移动官网那样用-rem？" aria-hidden="true" class="header-anchor">#</a> 适配能否像移动官网那样用 rem？</h3> <p>适配选型可以参照移动官网，一般微社区有两种做法：</p> <ol><li><p>布局百分比适配，字体与图片均为设计稿除 <code>2</code> 尺寸</p></li> <li><p><code>rem</code> 布局计算， 基准值 <code>100</code> ，下方为<code>&lt;head&gt;</code>里插入的适配代码</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">win<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>win<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> html <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">setFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> w <span class="token operator">=</span> html<span class="token punctuation">.</span>clientWidth<span class="token punctuation">,</span>
      h <span class="token operator">=</span> html<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
    html<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span>
      w <span class="token operator">&gt;</span> h <span class="token operator">?</span> <span class="token punctuation">(</span>w <span class="token operator">/</span> <span class="token number">1334</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">'px'</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span>w <span class="token operator">/</span> <span class="token number">750</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  doc<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> setFont<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  win<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> setFont<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  win<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> setFont<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> document<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ios-中-border-的-0-5-像素如何处理？"><a href="#ios-中-border-的-0-5-像素如何处理？" aria-hidden="true" class="header-anchor">#</a> IOS 中 BORDER 的 0.5 像素如何处理？</h3> <p>常规做法是判断 IOS 设备，给 BODY 添加 class，区别样式：</p> <ul><li>JS</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/iP(hone|od|ad)/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> v <span class="token operator">=</span> navigator<span class="token punctuation">.</span>appVersion<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/OS (\d+)_(\d+)_?(\d+)?/</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    version <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>version <span class="token operator">&gt;=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'hairlines'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>CSS：</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.hairlines .index</span> <span class="token punctuation">{</span>
  <span class="token property">border-width</span><span class="token punctuation">:</span> 0.5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="微社区数据统计接入"><a href="#微社区数据统计接入" aria-hidden="true" class="header-anchor">#</a> 微社区数据统计接入</h3> <p>接入参考：http://tguide.oa.com/index.php/ptt</p> <h2 id="二、开发环节"><a href="#二、开发环节" aria-hidden="true" class="header-anchor">#</a> 二、开发环节</h2> <div class="warning custom-block"><p>开发的每个功能环节，都依赖游戏的登录态。因此需要特别注意这点</p></div> <h3 id="js-里的登录态约定（确保功能正常的基础）"><a href="#js-里的登录态约定（确保功能正常的基础）" aria-hidden="true" class="header-anchor">#</a> JS 里的登录态约定（确保功能正常的基础）</h3> <p>微社区游戏的登录态，约定使用 sessionStorage 记录。字段：<code>dataSearch</code>，以下附上记录登录态代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> dataSearch <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">;</span> <span class="token comment">//获取URL参数</span>
<span class="token comment">//判断是否有内容或者是否是较为有效的登录态信息</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>
  <span class="token operator">!</span>sessionStorage<span class="token punctuation">.</span>dataSearch <span class="token operator">&amp;&amp;</span>
  dataSearch<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'appid'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span>
  dataSearch
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  sessionStorage<span class="token punctuation">.</span>dataSearch <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">;</span> <span class="token comment">//将登录态存到sessionStorage</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="双平台判断方法"><a href="#双平台判断方法" aria-hidden="true" class="header-anchor">#</a> 双平台判断方法</h3> <p>一般登录态格式如下：</p> <p>?partition=1011&amp;roleid=104994510013439323&amp;area=1&amp;algorithm=v2&amp;version=1.13.11×tamp=1494567380&amp;appid= wxfdab5af74990787a &amp;openid=oiz-ewRrOIHDAt88S5FquKqChdvw</p> <p><strong>判断规则</strong> ：</p> <p>最简单的方法是判断登录态的 appid 属性是否含有 wx 字符，例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//获取URL参数</span>
<span class="token keyword">function</span> <span class="token function">getParamVal</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  url <span class="token operator">=</span> url <span class="token operator">||</span> location<span class="token punctuation">.</span>search<span class="token punctuation">;</span>
  url <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\'|\&quot;|\&lt;|\&gt;/</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'(^|&amp;)'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'=([^&amp;]*)(&amp;|$)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> r <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> r<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//从sessionStorage的dataSearch中获得登录态的appid</span>
<span class="token keyword">var</span> appid <span class="token operator">=</span> <span class="token function">getParamVal</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">[</span><span class="token string">'dataSearch'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'appid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>appid<span class="token punctuation">,</span> <span class="token string">'appid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>appid<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'wx'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//游戏圈逻辑</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">//部落逻辑</span>
<span class="token punctuation">}</span>
</code></pre></div><p>VUE2.0 的判断方法：</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//微信平台：platform=&quot;wx&quot;、QQ平台：platform=&quot;qq&quot;、其他else</span>
computed <span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//双平台判断</span>
    <span class="token function-variable function">platform</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">[</span><span class="token string">'dataSearch'</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>sessionStorage<span class="token punctuation">[</span><span class="token string">'dataSearch'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;appid&quot;</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">var</span> appid <span class="token operator">=</span> <span class="token function">getParamVal</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">[</span><span class="token string">'dataSearch'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&quot;appid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>appid<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;wx&quot;</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">&quot;wx&quot;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token string">&quot;qq&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;else&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="三、测试环节"><a href="#三、测试环节" aria-hidden="true" class="header-anchor">#</a> 三、测试环节</h2> <h3 id="如何在-msdk-浏览器中模拟页面测试？"><a href="#如何在-msdk-浏览器中模拟页面测试？" aria-hidden="true" class="header-anchor">#</a> 如何在 MSDK 浏览器中模拟页面测试？</h3> <ol><li><p>使用 MSDK 浏览器测试客户端，见附件。IOS 使用 <code>itools</code>连接电脑进行安装即可</p></li> <li><p>用现有游戏微社区，JS 加白名单逻辑，跳转到你测试的页面</p></li></ol> <h3 id="如何抓游戏登录态？"><a href="#如何抓游戏登录态？" aria-hidden="true" class="header-anchor">#</a> 如何抓游戏登录态？</h3> <ol><li><p><code>WINDOWS</code> 使用 <code>fiddler</code> 抓包（需要注意 <code>HTTPS</code>，详细暂且百度）</p></li> <li><p><code>MAC</code> 使用 <code>charles</code> 抓包（需要注意 <code>HTTPS</code>，详细暂且百度）</p></li> <li><p>使用页面输出，复制到电脑，一般思路是用 <code>textarea</code> 装着。测试入口用下方白名单方式实现。<a href="http://hyrz.qq.com/ingame/v3/newsindex.shtml?acctype=qq&amp;appid=wx82dd7436af5db835&amp;openid=ozwwNj0TmLtqf8exbz-b9MIVR4gk&amp;access_token=3FQKEwGM8IsNJgl5UeNx6yPuaeCKm_C9-Ci6Q5ov_ePzwSNuIFV1IzdLHf25Uj572ylCij_F-lowLC1OUHcvws060WqR6jYtAMMKsU_I9rI&amp;platid=0&amp;areaid=1&amp;partition=100003&amp;appid=wx82dd7436af5db835&amp;version=2.15.0i&amp;timestamp=1482899807&amp;sig=f27f05d4ff98eb40e83c2061cdc67d61&amp;encode=2&amp;algorithm=v2&amp;user-agent=ios_sdk&amp;openid=ozwwNj0TmLtqf8exbz-b9MIVR4gk&amp;msdkEncodeParam=adcb70c3bfff67cb699e73f17e85068e180a973d88e4bb48d0cb8d4a67eaf7ec1a4ccef65cca5c434d9518d1a1f7ff359cae433b8963c80441f77c5ffd1fffa8fc228c5ab64b0e8f62b8134032c355503c291c77ca13526b46145f11cbe21d23ef402536c5f2f712425731dd2026b58f358262570c0af5305867ca201a8cb3739ca687464cc5253afade2759341ee998a1feba13d4a556ded6c54ea6589cd85d445c51c9d172da52229eab7080c39dc3c56e60241424a75c8bed29c08f07a8951185210368d07ff40491005bf0a8d444ac0b9f096028e321&amp;ADTAG=ingame.hyrz.push.match" target="_blank" rel="noopener noreferrer">参照例子<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: :</span> <span class="time">9/26/2019, 4:20:09 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fex-style/start/" class="prev router-link-active">快速上手</a></span> <span class="next"><a href="/fex-style/start/restructure-frontend-shape-screen.html">游戏内异形屏适配规范</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/fex-style/assets/js/app.3df72f28.js" defer></script><script src="/fex-style/assets/js/2.bcb6ef02.js" defer></script><script src="/fex-style/assets/js/33.d718e1d0.js" defer></script>
  </body>
</html>
